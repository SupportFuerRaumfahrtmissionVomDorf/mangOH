//--------------------------------------------------------------------------------------------------
/**
 * Implementation of the main menu screen.
 *
 * Copyright (C) Sierra Wireless Inc.
 */
//--------------------------------------------------------------------------------------------------

#include "cmdLine.h"
#include "mainMenu.h"
#include "ledScreen.h"
#include "buzzerScreen.h"

//--------------------------------------------------------------------------------------------------
/**
 * Draw the main menu.
 */
//--------------------------------------------------------------------------------------------------
static void DrawMainMenu
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    printf("\n= MAIN MENU =\n"
           "\n"
           "1. LEDs\n"
           "2. Buzzer\n"
           );
}


//--------------------------------------------------------------------------------------------------
/**
 * Handle a character of input while in the main menu.
 */
//--------------------------------------------------------------------------------------------------
static void HandleMainMenuInput
(
    const char* inputStr
)
//--------------------------------------------------------------------------------------------------
{
    switch (inputStr[0])
    {
        case '1':

            ledScreen_Enter();
            break;

        case '2':

            buzzerScreen_Enter();
            break;

        default:
            // Eat the invalid selection.
            return;
    }

    cmdLine_Refresh();
}


//--------------------------------------------------------------------------------------------------
/**
 * Leave the main menu.
 */
//--------------------------------------------------------------------------------------------------
static void Leave
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    cmdLine_Exit();
}


//--------------------------------------------------------------------------------------------------
/**
 * The Screen object for the main menu.
 */
//--------------------------------------------------------------------------------------------------
static Screen_t MainMenu =
{
    drawFunc: DrawMainMenu,
    inputProcessingFunc: HandleMainMenuInput,
    leaveFunc: Leave
};


//--------------------------------------------------------------------------------------------------
/**
 * Initialize the main menu screen.
 */
//--------------------------------------------------------------------------------------------------
void mainMenu_Init
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    // No initialization necessary.
}


//--------------------------------------------------------------------------------------------------
/**
 * Enter the main menu screen.
 */
//--------------------------------------------------------------------------------------------------
void mainMenu_Enter
(
    void
)
//--------------------------------------------------------------------------------------------------
{
    cmdLine_MenuMode();
    cmdLine_SetCurrentScreen(&MainMenu);
}
